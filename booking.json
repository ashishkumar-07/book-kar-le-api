{"openapi":"3.0.1","info":{"title":"BookingService","description":"Initiate and completes booking","version":"0.1"},"servers":[{"url":"http://localhost:8085/booking","description":"Generated server url"}],"paths":{"/place":{"post":{"tags":["booking-api-impl"],"summary":"Create a pending order and get the final price details along with fees and offers","operationId":"createOrder","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateBookingOrder"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/CreateBookingOrderResponse"}}}}}}},"/hold":{"post":{"tags":["booking-api-impl"],"summary":"Hold the seats selected by user","operationId":"putOnHold","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/HoldRequest"}}},"required":true},"responses":{"200":{"description":"OK"}}}},"/confirm":{"patch":{"tags":["booking-api-impl"],"summary":"marks order in-progress and initiate the payment with payment gateway","operationId":"confirmOrder","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ConfirmOrderRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ConfirmOrderResponse"}}}}}}},"/complete":{"patch":{"tags":["booking-api-impl"],"summary":"Once the user completes the payment from UI then UI call this API to mark the order complete and fetch the ticket status","operationId":"completeOrder","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CompleteOrderRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/CompleteOrderResponse"}}}}}}},"/seat-layout/{showId}":{"get":{"tags":["booking-api-impl"],"summary":"Get seat layout of a particular show with seat status","operationId":"seatMap","parameters":[{"name":"showId","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ShowSeatBooking"}}}}}}}},"/order-status/{userId}":{"get":{"tags":["booking-api-impl"],"summary":"Check current active order status of a particular user","operationId":"checkCurrentOrderStatus","parameters":[{"name":"userId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BookingOrder"}}}}}}},"/order-status/{userId}/{BookingOrderId}":{"get":{"tags":["booking-api-impl"],"summary":"Fetch ticket details of particular order","operationId":"fetchTicket","parameters":[{"name":"userId","in":"path","required":true,"schema":{"type":"string"}},{"name":"BookingOrderId","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BookingOrder"}}}}}}}},"components":{"schemas":{"CreateBookingOrder":{"type":"object","properties":{"userId":{"type":"string"},"cityId":{"type":"integer","format":"int64"},"theatreId":{"type":"integer","format":"int64"},"auditoriumId":{"type":"integer","format":"int64"},"movieId":{"type":"integer","format":"int64"},"language":{"type":"string"},"showId":{"type":"integer","format":"int64"},"seats":{"type":"array","items":{"type":"integer","format":"int64"}},"ticketQuantity":{"type":"integer","format":"int32"},"totalTicketPrice":{"type":"number"},"offerAmount":{"type":"number"},"amountAfterOffer":{"type":"number"},"offerId":{"type":"integer","format":"int64"}}},"CreateBookingOrderResponse":{"type":"object","properties":{"bookingOrderId":{"type":"string"},"convenienceFee":{"type":"number"},"baseAmountOfFee":{"type":"number"},"tax":{"type":"number"}}},"HoldRequest":{"type":"object","properties":{"showId":{"type":"integer","format":"int64"},"showSeatId":{"type":"array","items":{"type":"integer","format":"int64"}}}},"ConfirmOrderRequest":{"type":"object","properties":{"bookingOrderId":{"type":"string"},"paymentGatewayId":{"type":"string"}}},"ConfirmOrderResponse":{"type":"object","properties":{"orderId":{"type":"string"},"paymentGatewayOrderId":{"type":"string"},"paymentGatewayOrderStatus":{"type":"string"}}},"CompleteOrderRequest":{"type":"object","properties":{"bookingOrderId":{"type":"string"},"paymentGatewayTransactionId":{"type":"string"}}},"CompleteOrderResponse":{"type":"object","properties":{"paymentStatus":{"type":"string"},"ticketQrCodePath":{"type":"string"},"ticketImagePath":{"type":"string"}}},"ShowSeatBooking":{"type":"object","properties":{"showSeatId":{"type":"integer","format":"int64"},"showId":{"type":"integer","format":"int64"},"rowNumber":{"type":"string"},"seatNumber":{"type":"string"},"bookingStatus":{"type":"string","enum":["HOLD","IN_PROGRESS","BOOKED","AVAILABLE","NOT_AVAILABLE","SOLD_OUT"]},"bookingOrderId":{"type":"string"},"updatedAt":{"type":"string","format":"date-time"}}},"BookingOrder":{"type":"object","properties":{"bookingId":{"type":"string","format":"uuid"},"userId":{"type":"string"},"orderStatus":{"type":"string","enum":["PENDING","IN_PROGRESS","COMPLETED","CANCELLED","PAYMENT_REJECTED"]},"cityId":{"type":"integer","format":"int64"},"theatreId":{"type":"integer","format":"int64"},"auditoriumId":{"type":"integer","format":"int64"},"movieId":{"type":"integer","format":"int64"},"language":{"type":"string"},"showId":{"type":"integer","format":"int64"},"ticketQuantity":{"type":"integer","format":"int32"},"offerId":{"type":"integer","format":"int64"},"totalTicketPrice":{"type":"number"},"offerAmount":{"type":"number"},"amountAfterOffer":{"type":"number"},"paymentGatewayId":{"type":"string"},"paymentGatewayOrderId":{"type":"string"},"paymentGatewayTransactionId":{"type":"string"},"paymentGatewayOrderStatus":{"type":"string"},"ticketQrCodePath":{"type":"string"},"ticketImagePath":{"type":"string"}}}}}}