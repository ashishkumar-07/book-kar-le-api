{"openapi":"3.0.1","info":{"title":"BookingService","description":"Initiate and completes booking","contact":{"name":"Ashish K","email":"ashishkumar.sengar@gmail.com"},"license":{"name":"MIT License"},"version":"0.1"},"servers":[{"url":"http://localhost:8085/booking","description":"Generated server url"}],"tags":[{"name":"Movie booking APIs","description":"Following APIs are used to manage ticket booking"}],"paths":{"/hold":{"post":{"tags":["Movie booking APIs"],"summary":"Hold the seats selected by user","operationId":"putOnHold","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/HoldRequest"}}},"required":true},"responses":{"200":{"description":"OK"}}}},"/":{"post":{"tags":["Movie booking APIs"],"summary":"Create a pending order and get the final price details along with fees and offers","operationId":"createOrder_1","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateBookingOrder"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/CreateBookingOrderResponse"}}}}}}},"/confirm":{"patch":{"tags":["Movie booking APIs"],"summary":"marks order in-progress and initiate the payment with payment gateway","operationId":"confirmOrder","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ConfirmOrderRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ConfirmOrderResponse"}}}}}}},"/complete":{"patch":{"tags":["Movie booking APIs"],"summary":"Once the user completes the payment from UI then UI call this API to mark the order complete and fetch the ticket status","operationId":"completeOrder","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CompleteOrderRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/CompleteOrderResponse"}}}}}}},"/seat-layout/{showId}":{"get":{"tags":["Movie booking APIs"],"summary":"Get seat layout of a particular show with seat status","operationId":"seatMap","parameters":[{"name":"showId","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ShowSeatBooking"}}}}}}}},"/order-status/{userId}":{"get":{"tags":["Movie booking APIs"],"summary":"Check current active order status of a particular user","operationId":"checkCurrentOrderStatus","parameters":[{"name":"userId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BookingOrder"}}}}}}},"/order-status/{userId}/{BookingOrderId}":{"get":{"tags":["Movie booking APIs"],"summary":"Fetch ticket details of particular order","operationId":"fetchTicket","parameters":[{"name":"userId","in":"path","required":true,"schema":{"type":"string"}},{"name":"BookingOrderId","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BookingOrder"}}}}}}}},"components":{"schemas":{"HoldRequest":{"type":"object","properties":{"showSeatIds":{"type":"array","items":{"type":"integer","format":"int64"}}}},"CreateBookingOrder":{"type":"object","properties":{"userId":{"type":"string"},"showId":{"type":"integer","format":"int64"},"seatIds":{"type":"array","items":{"type":"integer","format":"int64"}},"ticketQuantity":{"type":"integer","format":"int32"},"totalTicketPrice":{"type":"number"},"offerAmount":{"type":"number"},"amountAfterOffer":{"type":"number"},"offerId":{"type":"integer","format":"int64"},"paymentGatewayId":{"type":"string"}}},"CreateBookingOrderResponse":{"type":"object","properties":{"bookingOrderId":{"type":"string","format":"uuid"},"convenienceFee":{"type":"number"},"baseAmountOfFee":{"type":"number"},"taxOnFee":{"type":"number"}}},"ConfirmOrderRequest":{"type":"object","properties":{"bookingOrderId":{"type":"string","format":"uuid"},"paymentGatewayId":{"type":"string"}}},"ConfirmOrderResponse":{"type":"object","properties":{"bookingOrderId":{"type":"string","format":"uuid"},"paymentGatewayOrderId":{"type":"string"},"paymentGatewayOrderStatus":{"type":"string"}}},"CompleteOrderRequest":{"type":"object","properties":{"bookingOrderId":{"type":"string","format":"uuid"},"paymentGatewayTransactionId":{"type":"string"}}},"CompleteOrderResponse":{"type":"object","properties":{"paymentStatus":{"type":"string"},"ticketQrCodePath":{"type":"string"},"ticketImagePath":{"type":"string"}}},"ShowSeatBooking":{"type":"object","properties":{"showSeatId":{"type":"integer","format":"int64"},"showId":{"type":"integer","format":"int64"},"rowNumber":{"type":"string"},"seatNumber":{"type":"string"},"bookingStatus":{"type":"string","enum":["HOLD","IN_PROGRESS","BOOKED","AVAILABLE","NOT_AVAILABLE","SOLD_OUT"]},"bookingOrderId":{"type":"string"},"updatedAt":{"type":"string","format":"date-time"},"versionNum":{"type":"string","format":"date-time"}}},"BookingOrder":{"type":"object","properties":{"bookingId":{"type":"string","format":"uuid"},"externalBookingId":{"type":"string"},"userId":{"type":"string"},"orderStatus":{"type":"string","enum":["PENDING","IN_PROGRESS","COMPLETED","CANCELLED","PAYMENT_REJECTED"]},"showId":{"type":"string"},"seatIds":{"type":"array","items":{"type":"integer","format":"int64"}},"ticketQuantity":{"type":"integer","format":"int32"},"offerId":{"type":"integer","format":"int64"},"totalTicketPrice":{"type":"number"},"offerAmount":{"type":"number"},"amountAfterOffer":{"type":"number"},"convenienceFee":{"type":"number"},"baseAmountOfFee":{"type":"number"},"taxOnFee":{"type":"number"},"paymentGatewayId":{"type":"string"},"paymentGatewayOrderId":{"type":"string"},"paymentGatewayTransactionId":{"type":"string"},"paymentGatewayOrderStatus":{"type":"string"},"ticketQrCodePath":{"type":"string"},"ticketImagePath":{"type":"string"}}}}}}